# =====================================================================
# DOCKER COMPOSE - WEB SERVICE
# =====================================================================
# Build và chạy Web (Next.js)
#
# ⚠️ LƯU Ý: API phải đang chạy trước khi start Web
#
# Sử dụng từ folder web/:
#   docker compose up -d --build
#
# Hoặc từ root:
#   docker compose -f web/docker-compose.yml up -d --build
# =====================================================================

services:
  # Web Service (Next.js)
  web:
    build:
      context: .
      dockerfile: Dockerfile
    container_name: web
    ports:
      - "3000:3000"
    environment:
      # Client-side URL (browser -> api)
      NEXT_PUBLIC_API_URL: ${NEXT_PUBLIC_API_URL:-http://localhost:8080/api/v1}
      # Server-side URL (web container -> api container qua network)
      API_URL: http://api:8080/api/v1
    networks:
      - ecommerce_network
    restart: always

networks:
  ecommerce_network:
    # Sử dụng external network từ API compose
    external: true
    name: api_ecommerce_network
